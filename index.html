<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>P√°gina de Vendas</title>
  <style>
    body { background: #FF69B4; margin: 0; font-family: Arial, sans-serif; }
    .page-border { border: 8px solid #FF1493; padding: 20px; max-width: 960px; margin: auto; }
    .sobre { background: #C71585; color: #fff; text-align: center; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
    .sobre img { width: 150px; height: auto; border-radius: 50%; display: block; margin: auto 0 15px; }
    .produtos { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
    .produto { background: #fff; width: 200px; padding: 15px; border-radius: 8px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .produto img { width: 100%; height: auto; border-radius: 4px; }
    .info { margin: 10px 0; font-size: 0.9em; color: #333; }
    .buy-button { background: #FF1493; color: #fff; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 1em; }
    .buy-button:hover { background: #C71585; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); align-items: center; justify-content: center; }
    .modal-content { background: #fff; border-radius: 8px; width: 90%; max-width: 400px; padding: 20px; }
    .tabs { display: flex; margin-bottom: 15px; }
    .tabs button { flex: 1; padding: 8px; border: none; background: #eee; cursor: pointer; }
    .tabs button.active { background: #C71585; color: #fff; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .tab-content img { display: block; margin: 10px auto; width: 200px; height: 200px; }
    .tab-content label { display: block; margin: 8px 0 4px; font-weight: bold; }
    .tab-content input, .tab-content textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
    .tab-content textarea { resize: vertical; }
    .submit-btn { margin-top: 15px; width: 100%; padding: 10px; background: #28a745; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    .submit-btn:hover { background: #218838; }
    .close-btn { margin-top: 10px; text-align: center; color: #FF1493; cursor: pointer; }
  </style>
</head>
<body>
  <div class="page-border">
    <div class="sobre">
      <img src="eliza.jpg" alt="Eliza Gabriela">
      <h2>Eliza Gabriela</h2>
      <h3>Laceira</h3>
      <p>Sou empreendedora de la√ßos h√° 1 ano, comecei do nada para entregar tudo para as mam√£es que amam deixar sua princesa ainda mais linda.</p>
      <p>Tenho 25 anos e sou m√£e do Jo√£o Pedro e da Anna Lis.</p>
      <p>Comecei com minha princesa Lis para realizar o sonho de ter uma princesa e fazer da minha paix√£o minha fonte de renda.</p>
      <p><em>Sempre ser√° um prazer atender voc√™!</em></p>
    </div>

    <div class="produtos" id="produtos"></div>
  </div>

  <div class="modal" id="modal">
    <div class="modal-content">
      <div class="tabs">
        <button class="tab-btn active" data-tab="pagamento">Pagamento</button>
        <button class="tab-btn" data-tab="entrega">Entrega</button>
        <button class="tab-btn" data-tab="retirada">Retirar</button>
      </div>
      <div class="tab-content active" id="pagamento">
        <h3>Escaneie o QR Pix</h3>
        <img id="qrImage" src="" alt="QR Pix">
      </div>
      <div class="tab-content" id="entrega">
        <label>Nome:</label><input type="text" id="entrega-nome">
        <label>Endere√ßo:</label><textarea id="entrega-endereco"></textarea>
        <label>N√∫mero:</label><input type="text" id="entrega-numero">
        <label>Cidade:</label><input type="text" id="entrega-cidade">
        <label>Bairro:</label><input type="text" id="entrega-bairro">
        <label>WhatsApp:</label><input type="text" id="entrega-whatsapp">
      </div>
      <div class="tab-content" id="retirada">
        <label>WhatsApp para contato:</label><input type="text" id="retirada-whatsapp">
      </div>
      <button class="submit-btn" id="finalizarBtn">Finalizar</button>
      <div class="close-btn" id="closeModal">Cancelar</div>
    </div>
  </div>

  <script>
    const products = [
      { id: '1', img: 'imagem1.jpg', nome: 'Colete M', valor: '25.0' },
      { id: '2', img: 'imagem2.jpg', nome: 'Colete G', valor: '30.0' },
      { id: '3', img: 'imagem3.jpg', nome: 'Colete GG', valor: '37.0' },
      { id: '4', img: 'imagem4.jpg', nome: 'Colete P', valor: '20.0' },
      { id: '5', img: 'imagem5.jpg', nome: 'Colete M', valor: '30.0' }
    ];

    const container = document.getElementById('produtos');
    const modal     = document.getElementById('modal');
    const qrImage   = document.getElementById('qrImage');
    const closeBtn  = document.getElementById('closeModal');
    const tabBtns   = document.querySelectorAll('.tab-btn');
    let currentProduct;

    // Renderiza produtos
    products.forEach(p => {
      const div = document.createElement('div');
      div.className = 'produto';
      div.innerHTML = `
        <img src="${p.img}" alt="${p.nome}">
        <div class="info"><strong>${p.nome}</strong><br>Valor: R$ ${p.valor.replace('.', ',')}</div>
        <button class="buy-button" data-id="${p.id}">Comprar</button>
      `;
      container.appendChild(div);
    });

    // Abre modal
    container.addEventListener('click', async e => {
      if (!e.target.matches('.buy-button')) return;
      const id = e.target.dataset.id;
      currentProduct = products.find(x => x.id === id);
      // gera QR Pix
      const res = await fetch(`/.netlify/functions/generateQr?productId=${id}`);
      const data = await res.json();
      qrImage.src = data.qr_code;
      // mostra modal
      modal.style.display = 'flex';
      // reset tabs
      tabBtns.forEach(b => b.classList.toggle('active', b.dataset.tab === 'pagamento'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.toggle('active', c.id === 'pagamento'));
    });

    // Muda abas
    tabBtns.forEach(btn => btn.addEventListener('click', () => {
      tabBtns.forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById(btn.dataset.tab).classList.add('active');
    }));

    // Finalizar
    document.getElementById('finalizarBtn').addEventListener('click', () => {
      let msg = `‚ú® Novo pedido: ${currentProduct.nome} - R$ ${currentProduct.valor}\n`;
      if (document.getElementById('entrega').classList.contains('active')) {
        msg += `\nüì¶ Entrega\nNome: ${document.getElementById('entrega-nome').value}\n` +
               `Endere√ßo: ${document.getElementById('entrega-endereco').value}, n¬∫ ${document.getElementById('entrega-numero').value}\n` +
               `Cidade: ${document.getElementById('entrega-cidade').value}\n` +
               `Bairro: ${document.getElementById('entrega-bairro').value}\n` +
               `WhatsApp: ${document.getElementById('entrega-whatsapp').value}`;
      } else {
        msg += `\nüè† Retirar pessoalmente\nWhatsApp: ${document.getElementById('retirada-whatsapp').value}`;
      }
      const url = `https://wa.me/5531987961356?text=${encodeURIComponent(msg)}`;
      window.open(url, '_blank');
      modal.style.display = 'none';
    });

    closeBtn.addEventListener('click', () => modal.style.display = 'none');
  </script>
</body>
</html>
